(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pagesPost-posts-commentList"],{"1eab":function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i={props:{type:String,color:String,size:[Number,String]},computed:{fontSize:function(){return"".concat(this.size,"px")}},methods:{onClick:function(){this.$emit("click")}}};n.default=i},"63c7":function(t,n,e){"use strict";e.r(n);var i=e("1eab"),o=e.n(i);for(var s in i)"default"!==s&&function(t){e.d(n,t,function(){return i[t]})}(s);n["default"]=o.a},"7efa":function(t,n,e){"use strict";e.r(n);var i=e("fde5"),o=e("63c7");for(var s in o)"default"!==s&&function(t){e.d(n,t,function(){return o[t]})}(s);var a=e("2877"),u=Object(a["a"])(o["default"],i["a"],i["b"],!1,null,null,null);n["default"]=u.exports},8126:function(t,n,e){"use strict";e.r(n);var i=e("b31e"),o=e.n(i);for(var s in i)"default"!==s&&function(t){e.d(n,t,function(){return i[t]})}(s);n["default"]=o.a},b31e:function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=a(e("a34a")),o=e("2f62"),s=a(e("7efa"));function a(t){return t&&t.__esModule?t:{default:t}}function u(t,n,e,i,o,s,a){try{var u=t[s](a),c=u.value}catch(r){return void e(r)}u.done?n(c):Promise.resolve(c).then(i,o)}function c(t){return function(){var n=this,e=arguments;return new Promise(function(i,o){var s=t.apply(n,e);function a(t){u(s,i,o,a,c,"next",t)}function c(t){u(s,i,o,a,c,"throw",t)}a(void 0)})}}function r(t){for(var n=1;n<arguments.length;n++){var e=null!=arguments[n]?arguments[n]:{},i=Object.keys(e);"function"===typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(e).filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.forEach(function(n){l(t,n,e[n])})}return t}function l(t,n,e){return n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}var m={components:{uniIcon:s.default},data:function(){return{showLoadMore:!1,loadMoreText:"加载中...",postId:"",commentId:0,commentList:[],commentCount:0,commnetPage:1,commentTimestamp:0}},computed:r({},(0,o.mapState)(["hasLogin"])),methods:{commentLike:function(){var t=c(i.default.mark(function t(n){var e,o,s;return i.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(this.hasLogin){t.next=3;break}return uni.navigateTo({url:"/pages/auth/login"}),t.abrupt("return");case 3:return e={comment_id:n.id},console.log("commentLike",e),uni.showLoading({mask:!0,title:"提交中..."}),t.next=8,this.$store.dispatch("postCommentLikeAction",e);case 8:o=t.sent,uni.hideLoading(),0==o.code?o.data&&(s=o.data.score||0,s&&uni.showToast({title:"点赞评论获得"+o.data.score+"积分",icon:"success"})):uni.showToast({title:o.message,icon:"none"});case 11:case"end":return t.stop()}},t,this)}));function n(n){return t.apply(this,arguments)}return n}(),commentListGet:function(){var t=c(i.default.mark(function t(){var n,e,o,s=this;return i.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return n={post_id:this.postId,page:this.commnetPage||1,timestamp:this.commentTimestamp},console.log("commentListGet params",n),t.next=4,this.$store.dispatch("postCommentListGet",n);case 4:return e=t.sent,console.log("commentListGet ret",e),0==e.code&&(o=e.data.rows,o.length&&(o.forEach(function(t){s.commentList.push(t)}),this.commentCount=e.data.count,this.commnetPage=e.data.page+1,this.commentTimestamp=e.data.timestamp)),t.abrupt("return",e);case 8:case"end":return t.stop()}},t,this)}));function n(){return t.apply(this,arguments)}return n}(),goToCommentDetail:function(t){uni.navigateTo({url:"/pagesPost/posts/commentDetail?post_id="+this.postId+"&comment_id="+t.id})}},onLoad:function(t){var n=t.post_id;this.postId=n,this.commentListGet()},onReachBottom:function(){var t=c(i.default.mark(function t(){var n;return i.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return this.showLoadMore=!0,t.next=3,this.commentListGet();case 3:n=t.sent,0==n.code&&0==n.data.rows.length?this.loadMoreText="没有更多了":this.showLoadMore=!1;case 5:case"end":return t.stop()}},t,this)}));function n(){return t.apply(this,arguments)}return n}(),onPullDownRefresh:function(){var t=c(i.default.mark(function t(){return i.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return console.log("onPullDownRefresh"),this.commnetPage=1,this.commentList=[],this.commentTimestamp=0,t.next=6,this.commentListGet();case 6:uni.stopPullDownRefresh();case 7:case"end":return t.stop()}},t,this)}));function n(){return t.apply(this,arguments)}return n}()};n.default=m},bc5a:function(t,n,e){"use strict";var i=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("v-uni-view",{staticClass:"uni-page-body"},[t.commentList.length?e("v-uni-view",{staticClass:"uni-bg-white post-comments"},[e("v-uni-view",{},t._l(t.commentList,function(n,i){return e("v-uni-view",{key:i,staticClass:"uni-flex uni-common-pa"},[e("v-uni-view",{staticClass:"uni-common-pr"},[e("v-uni-image",{staticStyle:{width:"60upx",height:"60upx","border-radius":"30upx"},attrs:{"lazy-load":"true",src:n.user_info.avatar,mode:""}})],1),e("v-uni-view",{staticClass:"uni-flex-item"},[e("v-uni-view",{staticClass:"uni-flex"},[e("v-uni-view",{staticClass:"uni-flex-item"},[t._v(t._s(n.user_info.nickname))]),e("v-uni-view",{staticClass:"uni-right",on:{click:function(e){e=t.$handleEvent(e),t.commentLike(n)}}},[e("v-uni-image",{staticStyle:{width:"40upx",height:"40upx"},attrs:{"lazy-load":"true",src:"../../static/icon/posts/zan.png",mode:""}})],1),e("v-uni-view",{staticClass:"uni-right uni-text-gray uni-common-ml-sm uni-common-pr",on:{click:function(e){e=t.$handleEvent(e),t.commentLike(n)}}},[t._v(t._s(n.likes))]),e("v-uni-view",{staticClass:"uni-right",on:{click:function(e){e=t.$handleEvent(e),t.commentReply(n)}}},[e("v-uni-image",{staticStyle:{width:"40upx",height:"40upx"},attrs:{"lazy-load":"true",src:"../../static/icon/posts/comment.png",mode:""}})],1),e("v-uni-view",{staticClass:"uni-right uni-text-gray uni-common-ml-sm",on:{click:function(e){e=t.$handleEvent(e),t.commentReply(n)}}},[t._v(t._s(n.replys.length))])],1),e("v-uni-view",{staticClass:"uni-text-gray uni-text-small"},[t._v(t._s(n.create_date))]),e("v-uni-view",{staticClass:"uni-comment-content"},[t._v(t._s(n.info))]),n.replys.length?e("v-uni-view",{staticClass:"uni-common-pa uni-bg-gray uni-common-mt",on:{click:function(e){e=t.$handleEvent(e),t.goToCommentDetail(n)}}},t._l(n.replys,function(n,i){return e("v-uni-view",{key:i,staticClass:"uni-common-mb"},[e("v-uni-view",{},[t._v(t._s(n.user_info.nickname||""))]),e("v-uni-view",{staticClass:"uni-text-small"},[t._v(t._s(n.info))])],1)}),1):t._e()],1)],1)}),1)],1):e("v-uni-view",{staticClass:"uni-common-mt post-comments"},[e("v-uni-view",{staticClass:"uni-common-pa uni-center"},[t._v("暂无评论")])],1),t.showLoadMore?e("v-uni-view",{staticClass:"uni-loadmore"},[t._v(t._s(t.loadMoreText))]):t._e()],1)},o=[];e.d(n,"a",function(){return i}),e.d(n,"b",function(){return o})},f0ef:function(t,n,e){"use strict";e.r(n);var i=e("bc5a"),o=e("8126");for(var s in o)"default"!==s&&function(t){e.d(n,t,function(){return o[t]})}(s);var a=e("2877"),u=Object(a["a"])(o["default"],i["a"],i["b"],!1,null,"9772654a",null);n["default"]=u.exports},fde5:function(t,n,e){"use strict";var i=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("v-uni-view",{staticClass:"uni-icon",class:["uni-icon-"+t.type],style:{color:t.color,"font-size":t.fontSize},on:{click:function(n){n=t.$handleEvent(n),t.onClick()}}})},o=[];e.d(n,"a",function(){return i}),e.d(n,"b",function(){return o})}}]);